steps:
  - script: |
      echo "Running Trivy remote registry scan..."
      trivy image \
        --exit-code 1 \
        --severity HIGH,CRITICAL \
        --username "$ACR_USERNAME" \
        --password "$ACR_PASSWORD" \
        "$dockerRegistry/$dockerImageName:latest"
    displayName: "Trivy Scan on ACR Image"
    env:
      ACR_USERNAME: ${{ variables.ACR_USERNAME }}
      ACR_PASSWORD: ${{ variables.ACR_PASSWORD }}
      dockerRegistry: ${{ variables.dockerRegistry }}
      dockerImageName: ${{ variables.dockerImageName }}
